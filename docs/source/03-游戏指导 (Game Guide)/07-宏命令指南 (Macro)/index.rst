
.. contents::
    :local:

.. _macro-guide:

宏命令编程手册 (Macro Guide)
===============================================================================


目录
------------------------------------------------------------------------------

.. autotoctree::
    :maxdepth: 1


基础宏命令
-------------------------------------------------------------------------------
- ``#showtooltip``: 放在宏命令的第一行, 表示该宏命令显示技能提示说明

**cast** 系列

- ``/cast 等级<n> <spell_name>``: 释放某个法术, 例如 ``/cast 等级3 火球术``。
- ``/cast [mod:alt] <spell_name1>(等级 <n1>); <spell_name2>(等级 <n2>)``: 按下该键时, 释放的是法术1。如果按下Alt键同时按下该键, 则释放法术2。当然可以把 ``[mod:alt]`` 改成 ``[mod:shift]``, 例如法师的冰箭冰枪宏: ``/cast [mod:alt] 冰霜長矛(等级 3); 寒冰箭(等级 16)``
- ``/cast [stance:1] <spell_name>``: 如果是某个姿态，则施放某个技能。例如::

    /cast [stance:1] 野性冲锋 - 熊形态
    /cast [stance:3] 野性冲锋 - 豹形态

- ``/castrandom <spell_nam1>, <spell_name2>, <spell_name3>``: 随机施放三个法术中的一个
- ``/cast [target=pet,nodead,exists] <spell_nam1>; <spellname_2>``: 按下该键时, 有重复则施放技能1, 否则则施放技能2
- ``/cast [target=mouseover] <spell_name>``: 不需要选中目标, 直接对鼠标悬停的目标施放技能。在RAID中盯紧MT的血, 以及在竞技场中快速转火或是快速抬血中都起着不可小视的作用。
- ``/cast disenchant; /use item name`` 由于商业技能其实也是法术, 所以用宏来定义商业技能行为。
- ``/stopcasting``: 取消当前施法动作。
- ``/stopattack``: 取消当下的攻击动作。

**pet** 系列

- ``/petpassive``: 设置宠物为被动模式
- ``/petattack [harm]``: 如果是敌人, 攻击敌人。
- ``/petfollow [noharm]``: 如果是友军, 宠物跟随自己。

**target** 系列

- ``/target <name>``: 在附近搜索并选择名字为<name>的目标, 例如 ``/target 奈法利安``。常用于:

    1. 寻找稀有怪
    2. 在一群密集的人群中选中某个NPC

- ``/target player``: 选择自己。
- ``/targetlasttarget``: 选取上一个选定的目标。
- ``/targetparty``: 依次选择队伍中的玩家。
- ``/targetraid``: 依次选择团队中的玩家。
- ``/targetenemy [harm]``: 依次选择敌人。
- ``/targetfriend [help]``: 依次选择友军。
- ``/cleartarget``: 取消当前已选中的目标

- ``/assist``: 选择当前目标的目标。
- ``/dismount``: 下马。
- ``/stopmacro [noharm]``: 如果目标是非敌方单位则停止该宏命令。
- ``/script SetCVar("cameraDistanceMax", 40)``: 设置摄像头最大距离为40码。


高级宏命令
-------------------------------------------------------------------------------


Mouseover
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
::

    /cast [target=mouseover]快速治疗

我们已经熟悉这个强大的词语，他能让我们在无需选中目标的情况下，对鼠标指向的目标施放法术。这能使我们不需要转换当前目标而对另一个目标施放法术，在RAID中盯紧MT的血，以及在竞技场中快速转火或是快速抬血中都起着不可小视的作用。

Tips: 

鼠标指向的目标，包括玩家的模型，GRID框体，或者各种头像框体(目标、目标的目标、焦点、焦点的目标...)。


Harm; Help
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
::

    /cast [harm]暗言术：痛;[help]快速治疗

这是一个常用的判断宏，如果目标是敌对，则施放痛，如果目标友善，则施放快速治疗。这个宏可以使我们在同一个键位上安置2个技能，用以节省技能栏键位。

Tips:

这种宏最好的组合是一个有CD的法术与一个无CD的法术捆绑，宏图标显示有CD的那个法术的说明和CD，此时我们需要用到下面所述的语句：

::

    #showtooltip
    #showtooltip 神圣之火
    /cast [harm]神圣之火;[help]恢复

注意

``#showtooltip`` 后不接任何技能名时，将依据当前条件显示技能图标说明及CD，比如上述宏，如果 ``#showtooltip`` 不接任何技能名时，目标敌对则显示神圣之火图标、说明及CD，目标友善则显示恢复的，如果没有目标，则图标显示默认的“问号”图标。

``#showtooltip`` 空格接技能名，此时，这个宏在技能栏上将显示神圣之火的图标，并且监视神圣之火的CD，由于恢复没有CD(被打断除外，打断可以通过其他同系法术监视)，我们可以将恢复的图标从技能栏上移除，整合进神圣之火的键位，这就是将有CD法术和无CD法术捆绑的意义。


Modifier/Mod; Button/btn
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- ``modifier:xxxx`` 表示 按下组合键xxxx 时，而mod则是modifier的简写。
- ``button:x`` 表示 鼠标X键点击宏 时，而btn则是button的简写。(btn:1鼠标左键，2代表鼠标右键，3代表鼠标中键，依次类推，高端鼠标还有btn:45678...)

如：
- ``[mod:alt]`` 表示按住alt时如何如何
- ``[modifier:shift]`` 表示按住shift时怎样怎样
- ``[btn:2]`` 鼠标右键点击时使用oo技能
- ``[button:3]`` 鼠标中键点击时使用xx技能

Tips:

如果不使用宏，系统默认alt为自我施法键，如果你要使用鼠标指向宏，则自我施法键无法生效，必须将“按住alt则对自己释放XX法术”写入宏语句中。

例子::

    #showtooltip 神圣之火
    /cast [modifier:alt,target=player]恢复;[target=mouseover,help,exists]恢复;[target=mouseover,harm,exists]神圣之火;[harm]神圣之火;[help]恢复

优先执行的顺序如下:

1. 按住alt，(无论鼠标指向谁，当前目标是谁)则对自己施放恢复;
2. 未使用alt时，(无论当前目标是谁)
3. 如果鼠标指向友方目标，则对指向目标施放恢复,指向敌方目标，则对指向目标施放神圣之火; 未使用alt，且鼠标未指向任何目标时，如果目标是敌对，则释放神圣之火，如果目标是友善，则释放恢复。这里要将mod:alt条件写在第一句，就是为了让任何情况下——不论鼠标指向谁，不论当前目标是敌是友——只要按下alt，则对自己施法。
